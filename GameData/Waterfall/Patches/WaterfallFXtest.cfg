

@PART[nuclearEngine]:AFTER[ReStock]
{
  MODULE
  {
    name = ModuleWaterfallFX
    moduleID = nuclearEngine
    // This links the effects to a given ModuleEngines
    engineID = basicEngine

    // List out all controllers we want available
    CONTROLLER
    {
      name = atmosphereDepth
      linkedTo = atmosphere_density
    }
    CONTROLLER
    {
      name = throttle
      linkedTo = throttle
    }

    
    // List of all EFFECTS
    EFFECT
    {
      // Alias for things
      name = outerShell2
      parentName = thrustTransform
      MODEL
      {
        path = Waterfall/Assets/wf_test_basic

        positionOffset = 0, 0, 0
        rotationOffset = 0, 0, 0
        // Base material properties
        MATERIAL
        {
          transform = FX
          shader = KSP/waterfall
          TEXTURE
          {
            textureSlotName = _MainTex
            texturePath = Waterfall/Assets/fx-noise-1
            textureScale = 1, 1.0
          }
          FLOAT
          {
            floatName = _TintFalloff
            value = 1
          }
          FLOAT
          {
            floatName = _Falloff
            value = 3.4
          }
          FLOAT
          {
            floatName = _Fresnel
            value = .93
          }
          FLOAT
          {
            floatName = _Noise
            value = 1
          }
          FLOAT
          {
            floatName = _Brightness
            value = 3.39
          }
          FLOAT
          {
            floatName = _SpeedX
            value = 0
          }
          FLOAT
          {
            floatName = _SpeedY
            value = 50
          }
          FLOAT
          {
            floatName = _TileX
            value = 1
          }
          FLOAT
          {
            floatName = _TileY
            value = 0.1
          }
          COLOR
          {
            colorName = _StartTint
            colorValue = 1, 1, 1, 1
          }
          COLOR
          {
            colorName = _EndTint
            colorValue = 0.3, 0.5, .2, .1
          }
        }
      }
      
      SCALEMODIFIER
      {
        name = throatScale
        // This should link to the NAME of the controller
        controllerName = atmosphereDepth
        // Type fo combination
        combinationType = MULTIPLY

        // The object to scale
        transformName = B_NozzleExit
        xCurve
        {
          key = 0 0.25 
          key = 1 0.25
        }
        yCurve
        {
          key = 0 0.08
          key = 1 0.25
        }
        zCurve
        {
          key = 0 0.25
          key = 1 0.25 
        }
      }

      SCALEMODIFIER
      {
        name = PlumeScale
        // This should link to the NAME of the controller
        controllerName = atmosphereDepth
        // Type fo combination
        combinationType = MULTIPLY

        // The object to scale
        transformName = B_NozzlePlume
        xCurve
        {
          key = 0 2
          key = 1 .5
        }
        yCurve
        {
          key = 0 0.14
          key = 1 .29
        }
        zCurve
        {
          key = 0 2
          key = 1 .5
        }
      }
    }

  }
}